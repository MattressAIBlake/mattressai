{% schema %}
{
  "name": "MattressAI Widget",
  "target": "body",
  "settings": [
    { 
      "type": "header",
      "content": "Widget Text & Branding"
    },
    { 
      "type": "text", 
      "id": "widget_title", 
      "label": "Widget title", 
      "default": "Chat with us",
      "info": "Main heading shown in the chat widget header"
    },
    { 
      "type": "text", 
      "id": "widget_subtitle", 
      "label": "Widget subtitle", 
      "default": "We're here to help",
      "info": "Subtitle shown below the title in header"
    },
    { 
      "type": "textarea", 
      "id": "welcome_message", 
      "label": "Welcome message", 
      "default": "Hi! How can we help you today?",
      "info": "First message displayed to grab shopper attention"
    },
    { 
      "type": "color", 
      "id": "primary_color", 
      "label": "Primary color", 
      "default": "#0F172A",
      "info": "Color for buttons, header, and chat bubble"
    },
    { 
      "type": "header",
      "content": "Chat Bubble"
    },
    { 
      "type": "select", 
      "id": "bubble_style", 
      "label": "Bubble style", 
      "options": [
        { "value": "icon", "label": "Icon only" },
        { "value": "text", "label": "Text only" },
        { "value": "icon_text", "label": "Icon + Text" }
      ],
      "default": "icon",
      "info": "What to display on the chat bubble"
    },
    { 
      "type": "text", 
      "id": "bubble_text", 
      "label": "Bubble text", 
      "default": "Chat",
      "info": "Text shown on bubble (if text style selected)"
    },
    { 
      "type": "range", 
      "id": "bubble_size", 
      "label": "Bubble size", 
      "min": 52,
      "max": 80,
      "step": 4,
      "unit": "px",
      "default": 64,
      "info": "Height of the chat bubble button"
    },
    { 
      "type": "header",
      "content": "Widget Position"
    },
    { 
      "type": "select", 
      "id": "position_horizontal", 
      "label": "Horizontal position", 
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "right", "label": "Right" }
      ],
      "default": "right",
      "info": "Which side of the screen to show the widget"
    },
    { 
      "type": "range", 
      "id": "position_bottom", 
      "label": "Bottom spacing", 
      "min": 10,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 20,
      "info": "Distance from bottom of screen"
    },
    { 
      "type": "range", 
      "id": "position_side", 
      "label": "Side spacing", 
      "min": 10,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 20,
      "info": "Distance from left or right edge"
    },
    { 
      "type": "header",
      "content": "Widget Size"
    },
    { 
      "type": "range", 
      "id": "widget_width", 
      "label": "Widget width", 
      "min": 300,
      "max": 500,
      "step": 20,
      "unit": "px",
      "default": 360,
      "info": "Width of the chat widget (desktop)"
    },
    { 
      "type": "range", 
      "id": "widget_height", 
      "label": "Widget height", 
      "min": 400,
      "max": 700,
      "step": 25,
      "unit": "px",
      "default": 550,
      "info": "Height of the chat widget (desktop)"
    },
    { 
      "type": "header",
      "content": "Widget Behavior"
    },
    { 
      "type": "checkbox", 
      "id": "auto_open", 
      "label": "Auto open on first visit", 
      "default": false 
    },
    { 
      "type": "checkbox", 
      "id": "show_compare", 
      "label": "Enable product comparison", 
      "default": true 
    },
    { 
      "type": "checkbox", 
      "id": "guided_mode", 
      "label": "Enable guided question mode", 
      "default": true 
    }
  ]
}
{% endschema %}

<!-- MattressAI Widget Root -->
<div 
  id="mattressai-root" 
  data-tenant="{{ shop.permanent_domain | escape }}"
  data-auto-open="{{ block.settings.auto_open }}"
  data-show-compare="{{ block.settings.show_compare }}"
  data-guided-mode="{{ block.settings.guided_mode }}"
  data-primary-color="{{ block.settings.primary_color }}"
  data-widget-title="{{ block.settings.widget_title | escape }}"
  data-widget-subtitle="{{ block.settings.widget_subtitle | escape }}"
  data-welcome-message="{{ block.settings.welcome_message | escape }}"
  data-bubble-style="{{ block.settings.bubble_style }}"
  data-bubble-text="{{ block.settings.bubble_text | escape }}"
  data-bubble-size="{{ block.settings.bubble_size }}"
  data-position-horizontal="{{ block.settings.position_horizontal }}"
  data-position-bottom="{{ block.settings.position_bottom }}"
  data-position-side="{{ block.settings.position_side }}"
  data-widget-width="{{ block.settings.widget_width }}"
  data-widget-height="{{ block.settings.widget_height }}"
></div>

<!-- Widget Assets -->
<script src="{{ 'tracking.js' | asset_url }}" data-tenant="{{ shop.permanent_domain | escape }}" defer></script>
<script src="{{ shop.url }}/apps/mattressai/widget.js?v=12" data-tenant="{{ shop.permanent_domain | escape }}" defer></script>
<link rel="stylesheet" href="{{ 'widget.css' | asset_url }}">